---
title: Урок 07 - Вращение
---

Следующий на очереди трансформаций - это вращение, то есть, берется угол и точка, которую мы хотим вращать относительно оси. Для этого всегда будут меняться 2 координаты из 3 (X, Y и Z), а одна останется без изменений. Это значит, что путь будет лежать на одной из 3-х основных плоскостей: XY (когда вращение вокруг Z), YZ (повороты относительно X) и XZ (для Y оси). Можно подобрать преобразования для вращения вокруг произвольной оси, но они довольно сложные и пока что нам не нужны.

Давайте определим задачу в общих чертах. Сосредоточимся на следующей диаграмме:

![](/images/t7_rotation.png)

Мы хотим двигаться по окружности из (x<sub>1,</sub>y<sub>1</sub>) в (x<sub>2,</sub>y<sub>2</sub>). Другими словами, мы хотим повернуть точку (x<sub>1,</sub>y<sub>1</sub>) на угол a<sub>2</sub>. Предположим, что радиус окружности равен 1. Это означает следующее:  
x<sub>1</sub>=cos(a<sub>1</sub>)  
y<sub>1</sub>=sin(a<sub>1</sub>)  
x<sub>2</sub>=cos(a<sub>1</sub>+a<sub>2</sub>)  
y<sub>2</sub>=sin(a<sub>1</sub>+a<sub>2</sub>)  

Мы будем использовать следующие тригонометрические тождества для нахождения x<sub>2</sub> и y<sub>2</sub>:  
cos(a+b) = cosacosb - sina sinb  
sin(a+b) = sinacosb+cosa sinb

Используя формулы выше, можем написать:  
x<sub>2</sub>=cos(a<sub>1</sub>+a<sub>2</sub>) = cosa<sub>1</sub>cosa<sub>2 </sub>- sina<sub>1</sub>sina<sub>2</sub> = x<sub>1</sub>cosa<sub>2 </sub>-y<sub>1</sub>sina<sub>2    
</sub>y<sub>2</sub>=sin(a<sub>1</sub>+a<sub>2</sub>) = sina<sub>1</sub>cosa<sub>2 </sub>+ cosa<sub>1</sub>sina<sub>2</sub> = y<sub>1</sub>cosa<sub>2 </sub> + x<sub>1</sub>sina<sub>2</sub>

В диаграмме мы смотрим на плоскость XY, а ось Z - это точка. Если X&Y части 4-вектора, тогда уравнения выше можно записать в форме матрицы (не затрагивая Z&W):

![](/images/t7_07_01.png)

Если мы хотим задать вращение для Y и X осей, то выражения будут похожи, а вот матрицы устроены слегка по другому. Вот матрица для вращения вокруг Y оси:

![](/images/t7_07_02.png)

И матрица вращения вокруг X оси:

![](/images/t7_07_03.png)

## [Прямиком к коду!](https://github.com/triplepointfive/ogldev/tree/master/tutorial07)

Изменения кода в этом уроке очень малы. Мы только изменяем значения единственной матрицы преобразований.

    World.m[0][0]=cosf(Scale); World.m[0][1]=-sinf(Scale); World.m[0][2]=0.0f; World.m[0][3]=0.0f;
    World.m[1][0]=sinf(Scale); World.m[1][1]=cosf(Scale);  World.m[1][2]=0.0f; World.m[1][3]=0.0f;
    World.m[2][0]=0.0f;        World.m[2][1]=0.0f;         World.m[2][2]=1.0f; World.m[2][3]=0.0f;
    World.m[3][0]=0.0f;        World.m[3][1]=0.0f;         World.m[3][2]=0.0f; World.m[3][3]=1.0f;

Легко заметить, что мы задали вращение вокруг Z оси. Вы можете попробовать вращение вокруг других осей, но мне кажется, что без настоящей проекции из 3D в 2D другие типы вращения будут выглядеть немного странно. Мы их реализуем в классе полноценного конвейера в следующих уроках.
